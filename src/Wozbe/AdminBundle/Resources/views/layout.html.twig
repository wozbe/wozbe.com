<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>{% block title %}{{ 'Admin'|trans }}{% endblock %}</title>
    
    <link rel="shortcut icon" href="{{ asset('favicon.ico') }}" />

    <!-- Bootstrap core CSS -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.1/css/bootstrap.min.css">
  </head>

  <body>
    <!-- Static navbar -->
    <div class="navbar navbar-default navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="{{ url('wozbe') }}">Wozbe</a>
        </div>
        <div class="navbar-collapse collapse">
          {% if is_granted('ROLE_USER') %}
          <ul class="nav navbar-nav navbar-right">
            <li><a href="{{ url('admin_logout') }}">{{ 'Logout'|trans }}</a></li>
          </ul>
          {% endif %}
        </div>
      </div>
    </div>
    
    <div class="container">
      <div class="row">
        <div class="col-md-3">
          {% block left_part %}
          <ul class="nav nav-pills nav-stacked">
            {% set route = app.request.attributes.get('_route') %}
            <li{% if 'wozbe_admin_dashboard' == route %} class="active"{% endif %}><a href="{{ url('wozbe_admin_dashboard') }}">{{ 'dashboard'|trans|capitalize }}</a></li>
            <li{% if 'wozbe_admin_post_list' == route %} class="active"{% endif %}><a href="{{ url('wozbe_admin_post_list') }}">{{ 'posts'|trans|capitalize }}</a></li>
            <li{% if 'wozbe_admin_comment_list' == route %} class="active"{% endif %}><a href="{{ url('wozbe_admin_comment_list') }}">{{ 'comments'|trans|capitalize }}</a></li>
            <li{% if 'wozbe' == route %} class="active"{% endif %}><a href="{{ url('wozbe_admin_post_list') }}">{{ 'references'|trans|capitalize }}</a></li>
          </ul>
          {% endblock %}
        </div>
        <div class="col-md-9">
          {% for flashMessage in app.session.flashbag.get('admin') %}
            <div class="alert alert-info">
              {{ flashMessage }}
            </div>
          {% endfor %}
          {% block content %}{% endblock %}
        </div>
      </div>
    </div>
    
    <div class="modal fade" id="modal-confirm" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title">{{ 'Please confirm action'|trans }}</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default btn-cancel" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary btn-confirm" data-dismiss="modal">Confirm</button>
          </div>
        </div>
      </div>
    </div>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.1/js/bootstrap.min.js"></script>
    <script type="text/javascript">
      (function() {
        // handlers order is important
        $('a[data-confirm]').on('click', handlerConfirm);
        $('a[data-method]').on('click', handlerMethod);

        function handlerMethod(event) {
          var $link = $(event.currentTarget);
          var method = $link.attr('data-method');
          var href = $link.attr('href');

          event.preventDefault();

          jQuery('<form action="' + href + '" method="POST">' + 
            '<input type="hidden" name="_method" value="' + method + '">' +
            '</form>').submit();
        }
        
        function handlerConfirm(event) {
          var $link = $(event.currentTarget);
          var confirmed = $link.attr('data-confirmed');
          var confirmMessage = $link.attr('data-confirm');
          
          if(confirmed) {
            return;
          }
          
          event.stopImmediatePropagation();
          event.stopPropagation();
          event.preventDefault();
          
          var $modalConfirm = jQuery('#modal-confirm');
          
          $modalConfirm.find('.modal-body').html(confirmMessage);
          $modalConfirm.find('.btn-confirm').on('click', function() {
            $link.attr('data-confirmed', true);
            $link.trigger('click');
          });
          $modalConfirm.modal({
            keyboard: false,
            backdrop: 'static'
          });
        }
      })();
    </script>
  </body>

</html>